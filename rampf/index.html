<!DOCTYPE html>
<meta charset="utf-8">
<title>鼠算式フレーズ練習帳</title>
<script type="module">
  import {QueryParser} from './js/query-parser.js';
  import {RabbitPhrase} from './js/rabbit-phrase.js';
  const main = () => {
    const queryParser = new QueryParser();
    const description = queryParser.getValue('descr', 'string', '');
    const questionTemplate = queryParser.getValue('qtempl', 'string', '');
    const answerTemplate = queryParser.getValue('atempl', 'string', '');
/*
    if (description) {
      const div = document.createElement('div');
      div.innerHTML = description;
      document.querySelector('#header').append(div);
    }
*/
    if (questionTemplate && answerTemplate) {
      
    }
const question = '^[私|あなた|私たち]は^^[車|食べること|いたずら]が大好きです。';
const answer = '^[I|You|We] love ^^[cars|eating|playing tricks].';

const random = Math.random();
const questionPhrase = new RabbitPhrase(question, random);
const answerPhrase = new RabbitPhrase(answer, random);
document.querySelector('#question').innerHTML = questionPhrase.html;
document.querySelector('#answer').innerHTML = answerPhrase.html;
const hoge = document.querySelectorAll('#question > [data-node-level]');
for (const fuga of hoge) {
  const nodeLevel = fuga.dataset.nodeLevel;
  const validNode = answerPhrase.validNodes[nodeLevel];
  const foo = document.createElement('span');
  foo.className = 'hint';
  foo.innerHTML = validNode;
  fuga.prepend(foo);
//  fuga.innerHTML = `<ruby>${fuga.innerHTML}<rt>${validNode}</rt>`;

}

//alert(answerPhrase.text);


  };



  window.addEventListener('DOMContentLoaded', main);
</script>
<style>
/*
  * {
    overflow: hidden;
    box-sizing: border-box;
  }
  html {
    height: 100%;
    font-size: min(1rem, 5vmin);
    font-family: sans-serif;
  }
  body {
    height: 100%;
    margin: 0;
    padding: .5rem;
  }
  #app_wrapper {
    display: table;
    width: 100%;
    height: 100%;
//    background: red;
  }
  #header {
    display: table-row;
    height: 0;
  }
  #main {
    display: table-row;
    height: auto;
//    background: violet;
  }
  #card_wrapper {
    display: table;
    width: 100%;
    height: 100%;
    background: gold;
  }
  #question_wrapper {
    display: table-row;
    height: auto;
  }
  #answer_wrapper {
    display: table-row;
    height: auto;
    background: blue;
  }
  #info_wrapper {
    display: table-row;
    height: 2rem;
    background: violet;
  }
  #question_hoge, #answer_hoge, #info_hoge {
    position: relative;
    width: 100%;
    height: 100%;
  }
  #question, #answer, #info {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    margin-left: -50%;
//    margin-top: -50%;
text-align: center;
background: white;
overflow-y: auto;
  }
  #footer {
    display: table-row;
    height: 1rem;
    text-align: right;
    background: lightblue;
  }
*/

  * {
    overflow: hidden;
    box-sizing: border-box;
  }
  html {
    height: 100%;
    font-size: min(1rem, 5vmin);
    font-family: sans-serif;
  }
  body {
    display: flex;
    flex-direction: column;
    height: 100%;
    margin: 0;
    padding: .5rem;
  }
  #main {
    display: flex;
    flex: 1 1 auto;
    flex-direction: column;
  }
  #lead {
  }
  #question {
    display: flex;
    flex: 1 1 auto;
    justify-content: center;
    align-items: center;
  }
  #answer {
    display: flex;
    flex: 1 1 auto;
    justify-content: center;
    align-items: center;
  }
  #statistic {
  }
  #footer {
    display: flex;
    justify-content: flex-end;
    align-items: center;
  }
  .node .hint {
    display: none;
    position: absolute;
    margin-top: -2em;
  }
  .node:hover .hint {
    display: block;
  }
  .node[data-node-level] {
    padding-right: .2em;
    padding-left: .2em;
    font-weight: bold;
  }
  .node[data-node-level="1"],
  .node[data-node-level="6"] {
    background-color: #F82F6666;
  }
  .node[data-node-level="2"],
  .node[data-node-level="7"] {
    background-color: #008ECF66;
  }
  .node[data-node-level="3"],
  .node[data-node-level="8"] {
    background-color: #70BE4766;
  }
  .node[data-node-level="4"],
  .node[data-node-level="9"] {
    background-color: #F55A2166;
  }
  .node[data-node-level="5"],
  .node[data-node-level="0"] {
    background-color: #F0EA3066;
  }

</style>
<div id="main">
  <div id="lead">lead</div>
  <div id="question"><div id="question_content"></div></div>
  <div id="answer"><div id="answer_content"></div></div>
  <div id="statistic">statistic</div>
</div>
<div id="footer"><small><b>鼠算式フレーズ練習帳</b> &copy; 2021 しかく<a href="https://twitter.com/shikaku1068">@shikaku1068</a></small></div>



<!--
<div id="app_wrapper">
  <div id="header"></div>
  <div id="main">
    <div id="card_wrapper">
      <div id="question_wrapper">
        <div id="question_hoge">
          <div id="question">aaaaaaaaaaaaaaaaaaaaaaa</div>
        </div>
      </div>
      <div id="answer_wrapper">
        <div id="answer_hoge">
          <div id="answer">aaaaaaaaaaaaaaaaaaaaaaa</div>
        </div>
      </div>
      <div id="info_wrapper">
        <div id="info_hoge">
          <div id="info">aaaaaaaaaaaaaaaaaaaaaaa</div>
        </div>
      </div>
    </div>
  </div>
  <div id="footer">
    <small>Powerd by 鼠算式フレーズ練習帳 &copy; 2021 しかく<a href="https://twitter.com/shikaku1068">@shikaku1068</a></small>
  </div>
</div>
-->